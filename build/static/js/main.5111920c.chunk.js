(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{287:function(e,t,r){e.exports=r.p+"static/media/login_background.207a3d95.jpg"},5601:function(e,t,r){e.exports=r(5919)},5606:function(e,t,r){},5919:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),o=r(18),s=r.n(o),i=(r(5606),r(31)),l=r(32),c=r(36),u=r(33),d=r(35),m=r(58),p=r(70),h=r(5920),g=r(5921),f=r(5922),E=r(5923),O=r(5924),b=r(34),y=r(287),v=r.n(y),I=r(37),j=r.n(I),k="http://localhost:3000/",C="users:updateUser",w="users:authenticateUser",_="users:logoutUser";function U(){return{type:"USER_LOGOUT"}}function S(){return function(e){var t=k+"users/logout";j()(t,{method:"post",withCredentials:!0}).then(function(t){200===t.status&&e({type:_,payload:{username:"",authenticate:!1}})}).catch(function(e){console.log(e)})}}var P=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(u.a)(t).call(this,e))).onAuthenticateUser=function(e,t){r.props.onAuthenticateUser(e,t)},r.authenticateUser=function(){r.onAuthenticateUser(r.state.username,r.state.password)},r.state={username:"",password:""},r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){e.user!==this.props.user&&this.props.history.push("/orders")}},{key:"render",value:function(){var e=this;return console.log(this.props.user),n.a.createElement("div",{style:{backgroundImage:"url(".concat(v.a,")"),backgroundSize:"cover",height:"100%",position:"absolute",width:"100%"}},n.a.createElement(h.a,{style:{marginTop:200}},n.a.createElement(g.a,{className:"bg-white m-5",title:"Login",style:{padding:10}},n.a.createElement("h1",null,"Login"),n.a.createElement(f.a,null,n.a.createElement(E.a,{name:"username",id:"username",placeholder:"username",onChange:function(t){return e.setState({username:t.target.value})}})),n.a.createElement(f.a,null,n.a.createElement(E.a,{type:"password",name:"email",id:"exampleEmail",placeholder:"password",onChange:function(t){return e.setState({password:t.target.value})}})),n.a.createElement(O.a,{color:"primary",size:"lg",onClick:function(t){return e.authenticateUser()},margin:"15px"},"Login")),n.a.createElement("br",null)))}}]),t}(a.Component),L={onAuthenticateUser:function(e,t){return function(r){var a={username:e,password:t},n=k+"users/authenticate";j()(n,{method:"post",data:a,withCredentials:!0}).then(function(e){var t;200===e.status?(r({type:w,payload:{authenticate:!0}}),r((t=e.data.username,{type:C,payload:{user:t}}))):alert("username password do not match")}).catch(function(e){console.log(e),e.response?401===e.response.status?alert("username password do not match"):400===e.response.status&&(console.log("please enter necassary fields"),alert("Please fill the necassary fields")):alert("Make sure the server is running")})}}},D=Object(p.d)(Object(b.b)(function(e){return{user:e.user}},L)(P)),A=r(53),N=r.n(A),x=r(80),q=r(22),R=r(81),T="orders:updateOrders",B="orders:updateOrder";var H=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(u.a)(t).call(this,e))).toggleHover=function(){r.setState({hover:!r.state.hover})},r.styles=function(e){return{fab:{margin:e.spacing.unit},extendedIcon:{marginRight:e.spacing.unit}}},r.updateOrder=function(){var e;e="OPEN"===r.state.status?"CLOSE":"OPEN",r.props.onUpdateOrder(r.state.id,e,r.props.orders)},r.state={id:r.props.order._id,createdBy:r.props.order.createdby,status:r.props.order.status},r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.order._id!==e.order._id&&this.setState({id:this.props.order._id,createdBy:this.props.order.createdby})}},{key:"render",value:function(){var e,t;return e=this.state.hover?{backgroundColor:"#ddd",margin:15,padding:20,cursor:"pointer"}:{backgroundColor:"#eee",margin:15,padding:20,cursor:"pointer"},t="OPEN"===this.state.status?n.a.createElement(R.b,null):n.a.createElement(R.c,null),n.a.createElement("div",null,n.a.createElement(N.a,null,n.a.createElement(q.c,{onMouseEnter:this.toggleHover,onMouseLeave:this.toggleHover,style:e},n.a.createElement(q.e,null,n.a.createElement(q.f,null,n.a.createElement(q.h,null,n.a.createElement(q.g,null,n.a.createElement(m.b,{to:"/orderDetails/".concat(this.state.id)},n.a.createElement("p",null,"OrderID ",this.state.id,n.a.createElement("br",null),"Created by ",this.state.createdBy))),n.a.createElement(q.g,null,n.a.createElement("h1",null,this.state.status)),n.a.createElement(q.g,null,n.a.createElement(q.a,{name:"btn",id:"updOrderBtn",onClick:this.updateOrder,"aria-label":"Delete",className:this.fab},t))))))))}}]),t}(a.Component),M={onUpdateOrder:function(e,t,r){var a=this;return function(r){var n=k+"orders/updateorder/"+e;j()(n,{method:"put",withCredentials:!0,data:{status:t}}).then(function(e){var t;r((t=e.data,{type:B,payload:{order:t}}))}).catch(function(e){401===e.status&&(alert("Session has timedout please login again "),a.props.history.push("/login"))})}}},G=Object(b.b)(function(e,t){return{user:e.user,orders:e.order,order:t.order}},M)(H),X=r(113),F=r.n(X),Q=r(5933),V=r(5925);function z(e){return n.a.createElement(q.k,{component:"div",style:{padding:24}},e.children)}var J=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(u.a)(t).call(this,e))).toggle=function(){r.setState({popoverOpen:!r.state.popoverOpen})},r.LogoutUser=function(){r.props.onLogoutUser()},r.handleChange=function(e,t){r.setState({tabNum:t})},r.state={tabNum:0,popoverOpen:!1},r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){e.user.authenticate!==this.props.user.authenticate&&(this.props.resetStore(),this.props.history.push("/login"))}},{key:"componentDidMount",value:function(){this.props.onGetOrders()}},{key:"render",value:function(){var e=this.state.tabNum;return n.a.createElement(N.a,null,n.a.createElement("div",null,n.a.createElement(x.a,{title:"Orders"},n.a.createElement(q.i,{value:e,onChange:this.handleChange},n.a.createElement(q.d,{label:"Open Orders"}),n.a.createElement(q.d,{label:"Closed Orders"})),n.a.createElement(q.b,{color:"inherit","aria-label":"Logout",id:"Popover1"},n.a.createElement(F.a,null)),n.a.createElement(Q.a,{placement:"bottom",isOpen:this.state.popoverOpen,target:"Popover1",toggle:this.toggle},n.a.createElement(V.a,{onClick:this.LogoutUser},"Logout"))),0===e&&n.a.createElement(z,null,n.a.createElement(x.b,null,this.props.order.filter(function(e){return"OPEN"===e.status}).map(function(e,t){return n.a.createElement(G,{key:t,order:e})}))),1===e&&n.a.createElement(z,null,n.a.createElement(x.b,null,this.props.order.filter(function(e){return"CLOSE"===e.status}).map(function(e,t){return n.a.createElement(G,{key:t,order:e})})))))}}]),t}(a.Component),Y={onGetOrders:function(){var e=k+"orders/getallorders";return function(t){j.a.get(e,{withCredentials:!0}).then(function(e){var r;200===e.status&&t((r=e.data,{type:T,payload:{orders:r}}))}).catch(function(e){console.log(e)})}},onLogoutUser:S,resetStore:U},K=Object(p.d)(Object(b.b)(function(e){return{user:e.user,order:e.order}},Y)(J)),W=r(176),Z=r.n(W),$=r(291),ee=(r(66),r(5926)),te="items:updateItems",re="items:updateOrderItems",ae="items:updateOrderPrice",ne="items:deleteOrderItems",oe="items:updateOrderItemQty",se="items:deleteOrderItem",ie="items:addAllItem",le="items:deleteAllItem",ce="items:deleteAllItems";function ue(e){return{type:re,payload:{items:e}}}function de(){return{type:ae}}function me(e){var t=this;return function(r){j.a.get(k+"items/getallitems",{withCredentials:!0}).then(function(t){var a=[];t.data.map(function(t){var r=!1;return e.map(function(e){return t._id===e.item._id&&(r=!0),e}),a.push({item:t,added:r}),t}),200===t.status?r({type:te,payload:{items:a}}):console.log("Items not found")}).catch(function(e){e.response&&401===e.response.status&&(alert("Session has timed out, please login again "),t.props.history.push("/login")),console.log(e)})}}var pe=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(u.a)(t).call(this,e))).containsItem=function(e,t){var r;for(r=0;r<t.length;r++)if(e===t[r].item._id)return r;return-1},r.toggleHover=function(){r.setState({hover:!r.state.hover})},r.styles=function(e){return{fab:{margin:e.spacing.unit},extendedIcon:{marginRight:e.spacing.unit}}},r.updateItem=function(e,t){var a=e.target.value-r.state.orderamount;r.updateItems(a)},r.updateItems=function(e){r.props.updateItemQty(e,r.state.orderId,r.state.id)},r.deleteItem=function(){r.props.deleteItem(r.state.orderId,r.state.id)},r.state={id:r.props.item.item._id,name:r.props.item.item.name,price:r.props.item.item.price,qtyonstock:r.props.item.item.qtyonstock,orderamount:r.props.item.orderamount,totalPrice:r.props.item.item.price*r.props.item.orderamount,items:r.props.items,orderId:r.props.orderId},r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.item.item._id!==e.item.item._id?this.setState({id:this.props.item.item._id,name:this.props.item.item.name,price:this.props.item.item.price,qtyonstock:this.props.item.item.qtyonstock,orderamount:this.props.item.orderamount,totalPrice:this.props.item.item.price*this.props.item.orderamount}):e.orderItems!==this.props.orderItems&&e.allItems===this.props.allItems&&this.setState({qtyonstock:this.props.item.item.qtyonstock,orderamount:this.props.item.orderamount,totalPrice:this.props.item.item.price*this.props.item.orderamount})}},{key:"render",value:function(){var e=this;return this.state.hover?{backgroundColor:"#ddd",margin:15,padding:20,cursor:"pointer"}:{backgroundColor:"#eee",margin:15,padding:20,cursor:"pointer"},n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},this.state.name),n.a.createElement("td",null,this.state.price),n.a.createElement("td",null," ",this.state.qtyonstock),n.a.createElement("td",null,n.a.createElement(ee.a,null,n.a.createElement(E.a,{name:this.state.name,placeholder:"Amount",min:0,value:this.state.orderamount,max:this.state.orderamount+this.state.qtyonstock,onChange:function(t,r){return e.updateItem(t,r)},type:"number",step:"1"}))),n.a.createElement("td",null,"Rs.",this.state.totalPrice),n.a.createElement("td",null,n.a.createElement(O.a,{close:!0,onClick:this.deleteItem})))}}]),t}(a.Component),he={deleteItem:function(e,t){var r=this;return function(a){var n=k+"orders/removeorderitems/"+e+"/"+t;j()(n,{method:"put",withCredentials:!0}).then(function(e){var t;200===e.status&&(a((t=e.data,{type:se,payload:{item:t}})),a(function(e){return{type:ie,payload:{item:e}}}(e.data)),a(de()))}).catch(function(e){401===e.status&&(alert("Session has timedout please login again "),r.props.history.push("/login")),console.log(e)})}},updateItemQty:function(e,t,r){var a=this;return function(n){var o=k+"orders/updateorderitems/"+t+"/"+r;j()(o,{method:"put",withCredentials:!0,data:{value:e}}).then(function(e){var t,a,o;200===e.status&&(n((t=r,a=e.data.orderamount,o=e.data.qtyonstock,{type:oe,payload:{itemID:t,orderamount:a,qtyonstock:o}})),n(de()))}).catch(function(e){console.log(e),401===e.status&&(alert("Session has timedout please login again "),a.props.history.push("/login")),400===e.response.status&&alert("Please enter a correct order amount")})}}},ge=Object(p.d)(Object(b.b)(function(e,t){return{allItems:e.item.allItems,orderItems:e.item.orderItems,item:t.item,items:t.items,orderId:t.orderId}},he)(pe)),fe=r(5927),Ee=r(5928),Oe=r(5929),be=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(u.a)(t).call(this,e))).addItems=function(){r.props.addItem(r.state.orderId,r.state.id)},r.state={id:r.props.item.item._id,name:r.props.item.item.name,price:r.props.item.item.price,orderId:r.props.orderId},r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.item.item._id!==e.item.item._id&&this.setState({id:this.props.item.item._id,name:this.props.item.item.name,price:this.props.item.item.price})}},{key:"render",value:function(){var e;return e=this.props.item.added?n.a.createElement(fe.a,{name:this.state.name,style:{backgroundColor:"#eee"},disabled:!0,onClick:this.addItems},n.a.createElement(Ee.a,null,n.a.createElement(Oe.a,null,n.a.createElement("h3",null,this.state.name," ")),n.a.createElement(Oe.a,null,n.a.createElement("p",{style:{float:"right"}},"Rs.",this.state.price)))):n.a.createElement(fe.a,{name:this.state.name,style:{backgroundColor:"#eee"},onClick:this.addItems},n.a.createElement(Ee.a,null,n.a.createElement(Oe.a,null,n.a.createElement("h3",null,this.state.name," ")),n.a.createElement(Oe.a,null,n.a.createElement("p",{style:{float:"right"}},"Rs.",this.state.price)))),n.a.createElement("div",null,e)}}]),t}(a.Component),ye={addItem:function(e,t){var r=this;return function(a){var n=k+"orders/addorderitems/"+e+"/"+t;j()(n,{method:"put",withCredentials:!0}).then(function(e){200===e.status&&(a(ue(e.data.items)),a({type:le,payload:{itemID:t}}))}).catch(function(e){e.response&&401===e.response.status&&(alert("Session has timedout please login again "),r.props.history.push("/login")),console.log(e)})}}},ve=Object(b.b)(function(e,t){return{item:t.item,orderId:t.orderId}},ye)(be),Ie=r(5930),je=r(5931),ke=r(5932),Ce=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(u.a)(t).call(this,e))).logoutUser=function(){r.props.onLogoutUser()},r.toggle=function(){r.setState({popoverOpen:!r.state.popoverOpen})},r.state={id:r.props.id,items:[],itemToAdd:"",totalPrice:0,allItems:[],popoverOpen:!1},r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){e.user.authenticate!==this.props.user.authenticate&&(this.props.resetStore(),this.props.history.push("/login"))}},{key:"componentDidMount",value:function(){var e=Object($.a)(Z.a.mark(function e(){return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.props.getItems(this.state.id);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,r=this;return 0===this.props.orderItems.length?(e=n.a.createElement("tr",null,n.a.createElement("td",null,"No Items On Order")),t=""):(e=this.props.orderItems.map(function(e,t){return n.a.createElement(ge,{key:t,orderId:r.state.id,item:e})}),t=n.a.createElement(Ie.a,{color:"primary",style:{float:"right"}}," ",n.a.createElement("h1",null,"Total Price : Rs.",this.props.totalPrice," "))),n.a.createElement(N.a,null,n.a.createElement("div",null,n.a.createElement(x.a,{title:"Order View"},n.a.createElement(q.j,null),n.a.createElement(q.b,{color:"inherit","aria-label":"Logout",onClick:function(){r.props.deleteOrderItems(),r.props.deleteAllItems(),r.props.history.push("../orders")}},n.a.createElement(R.c,null)),n.a.createElement(q.b,{color:"inherit","aria-label":"Logout",id:"Popover1"},n.a.createElement(R.a,null)),n.a.createElement(Q.a,{placement:"bottom",isOpen:this.state.popoverOpen,target:"Popover1",toggle:this.toggle},n.a.createElement(V.a,{onClick:this.logoutUser},"Logout"))),n.a.createElement(h.a,{style:{position:"absolute",width:"70%"}},n.a.createElement("div",null,n.a.createElement("h1",{style:{textAlign:"center",padding:10}},"Order Items"),n.a.createElement(je.a,{hover:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Item Name"),n.a.createElement("th",null,"Unit Price"),n.a.createElement("th",null,"Amount On Stock"),n.a.createElement("th",null,"Amount On Order"),n.a.createElement("th",null,"Price"),n.a.createElement("th",null))),n.a.createElement("tbody",null,e)),t)),n.a.createElement(h.a,{style:{position:"absolute",width:"30%",marginLeft:"65%",padding:20}},n.a.createElement("h1",{style:{textAlign:"center"}},"Item List"),n.a.createElement(ke.a,{style:{overflowY:"scroll",maxHeight:800}},this.props.allItems.map(function(e,t){return n.a.createElement(ve,{key:t,item:e,orderId:r.state.id})})))))}}]),t}(a.Component),we={getItems:function(e){var t=this,r=k+"orders/getorder/"+e;return function(e){j.a.get(r,{withCredentials:!0}).then(function(t){200===t.status?(e(ue(t.data.items)),e(de()),e(me(t.data.items))):console.log("Items not found")}).catch(function(e){e.response&&401===e.response.status&&(alert("Session has timed out, please login again "),t.props.history.push("/login")),console.log(e)})}},deleteOrderItems:function(){return{type:ne,payload:{items:[],price:0}}},deleteAllItems:function(){return{type:ce,payload:{items:[]}}},onLogoutUser:S,resetStore:U},_e=Object(p.d)(Object(b.b)(function(e,t){return{user:e.user,order:e.order,allItems:e.item.allItems,orderItems:e.item.orderItems,totalPrice:e.item.orderPrice,id:t.id.match.params.id}},we)(Ce)),Ue=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement(m.a,null,n.a.createElement("div",{className:"App"},n.a.createElement(p.a,{exact:!0,path:"/(login|)",render:function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement(D,null))}}),n.a.createElement(p.a,{exact:!0,path:"/orders",render:function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement(K,null))}}),n.a.createElement(p.a,{exact:!0,path:"/orderDetails/:id",render:function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement(_e,{id:e}))}})))}}]),t}(a.Component),Se=(r(5918),r(293)),Pe=r(71),Le=r(29);var De=Object(Pe.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{username:"",authenticate:!1},t=arguments.length>1?arguments[1]:void 0,r=t.type,a=t.payload;switch(r){case C:return console.log("test"),Object(Le.a)({},e,{username:a.user});case w:return Object(Le.a)({},e,{authenticate:a.authenticate});case _:return a;default:return e}},order:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=t.type,a=t.payload;switch(r){case T:return a.orders;case B:return e.map(function(e){return e._id===a.order._id&&(e=a.order),e});default:return e}},item:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{allItems:[],orderItems:[],orderPrice:0},r=arguments.length>1?arguments[1]:void 0,a=r.type,n=r.payload;switch(a){case te:return Object(Le.a)({},t,{allItems:n.items});case re:return Object(Le.a)({},t,{orderItems:n.items});case ae:var o=0;return e=t.orderItems.map(function(e){return o+=e.item.price*e.orderamount,e}),Object(Le.a)({},t,{orderPrice:o});case ne:return Object(Le.a)({},t,{orderItems:n.items,orderPrice:n.orderPrice});case se:return e=t.orderItems.filter(function(e){return n.item._id!==e.item._id}),Object(Le.a)({},t,{orderItems:e});case ie:return e=t.allItems.map(function(e){return e.item._id===n.item._id&&(e.added=!1),e}),Object(Le.a)({},t,{allItems:e});case le:return e=t.allItems.map(function(e){return e.item._id===n.itemID&&(e.added=!0),e}),Object(Le.a)({},t,{allItems:e});case ce:return Object(Le.a)({},t,{allItems:n.items});case oe:return e=t.orderItems.map(function(e){return e.item._id===n.itemID&&(e.orderamount=n.orderamount,e.item.qtyonstock=n.qtyonstock),e}),Object(Le.a)({},t,{orderItems:e});default:return t}}}),Ae=Object(Pe.d)(Object(Pe.a)(Se.a),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),Ne=Object(Pe.e)(function(e,t){return"USER_LOGOUT"===t.type&&(console.log("sadas"),e=void 0),De(e,t)},Ae);s.a.render(n.a.createElement(b.a,{store:Ne},n.a.createElement(Ue,null)),document.getElementById("root"))}},[[5601,1,2]]]);
//# sourceMappingURL=main.5111920c.chunk.js.map